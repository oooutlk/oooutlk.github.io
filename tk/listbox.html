<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Listbox</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="installing_tk.html"><strong aria-hidden="true">2.</strong> Installing Tk</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="installing_tk_on_windows.html"><strong aria-hidden="true">2.1.</strong> Installing Tk On Windows</a></li><li class="chapter-item expanded "><a href="installing_tk_on_linux.html"><strong aria-hidden="true">2.2.</strong> Installing Tk On Linux</a></li><li class="chapter-item expanded "><a href="installing_tk_on_freebsd.html"><strong aria-hidden="true">2.3.</strong> Installing Tk On FreeBSD</a></li></ol></li><li class="chapter-item expanded "><a href="a_first_real_example.html"><strong aria-hidden="true">3.</strong> A First (Real) Example</a></li><li class="chapter-item expanded "><a href="tk_concepts.html"><strong aria-hidden="true">4.</strong> Tk Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="widgets.html"><strong aria-hidden="true">4.1.</strong> Widgets</a></li><li class="chapter-item expanded "><a href="geometry_management.html"><strong aria-hidden="true">4.2.</strong> Geometry Management</a></li><li class="chapter-item expanded "><a href="event_handling.html"><strong aria-hidden="true">4.3.</strong> Event Handling</a></li></ol></li><li class="chapter-item expanded "><a href="basic_widgets.html"><strong aria-hidden="true">5.</strong> Basic Widgets</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="frame.html"><strong aria-hidden="true">5.1.</strong> Frame</a></li><li class="chapter-item expanded "><a href="label.html"><strong aria-hidden="true">5.2.</strong> Label</a></li><li class="chapter-item expanded "><a href="button.html"><strong aria-hidden="true">5.3.</strong> Button</a></li><li class="chapter-item expanded "><a href="checkbutton.html"><strong aria-hidden="true">5.4.</strong> Checkbutton</a></li><li class="chapter-item expanded "><a href="radiobutton.html"><strong aria-hidden="true">5.5.</strong> Radiobutton</a></li><li class="chapter-item expanded "><a href="entry.html"><strong aria-hidden="true">5.6.</strong> Entry</a></li><li class="chapter-item expanded "><a href="combobox.html"><strong aria-hidden="true">5.7.</strong> Combobox</a></li></ol></li><li class="chapter-item expanded "><a href="grid.html"><strong aria-hidden="true">6.</strong> The Grid Geometry Manager</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="columns_and_rows.html"><strong aria-hidden="true">6.1.</strong> Columns and Rows</a></li><li class="chapter-item expanded "><a href="spanning_multiple_cells.html"><strong aria-hidden="true">6.2.</strong> Spanning Multiple Cells</a></li><li class="chapter-item expanded "><a href="layout_within_the_cell.html"><strong aria-hidden="true">6.3.</strong> Layout within the Cell</a></li><li class="chapter-item expanded "><a href="handling_resize.html"><strong aria-hidden="true">6.4.</strong> Handling Resize</a></li><li class="chapter-item expanded "><a href="padding.html"><strong aria-hidden="true">6.5.</strong> Padding</a></li><li class="chapter-item expanded "><a href="additional_grid_features.html"><strong aria-hidden="true">6.6.</strong> Additional Grid Features</a></li><li class="chapter-item expanded "><a href="nested_layouts.html"><strong aria-hidden="true">6.7.</strong> Nested Layouts</a></li></ol></li><li class="chapter-item expanded "><a href="more_widgets.html"><strong aria-hidden="true">7.</strong> More Widgets</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="listbox.html" class="active"><strong aria-hidden="true">7.1.</strong> Listbox</a></li><li class="chapter-item expanded "><a href="scrollbar.html"><strong aria-hidden="true">7.2.</strong> Scrollbar</a></li><li class="chapter-item expanded "><a href="text.html"><strong aria-hidden="true">7.3.</strong> Text</a></li><li class="chapter-item expanded "><a href="scale.html"><strong aria-hidden="true">7.4.</strong> Scale</a></li><li class="chapter-item expanded "><a href="spinbox.html"><strong aria-hidden="true">7.5.</strong> Spinbox</a></li><li class="chapter-item expanded "><a href="progressbar.html"><strong aria-hidden="true">7.6.</strong> Progressbar</a></li></ol></li><li class="chapter-item expanded "><a href="event_loop.html"><strong aria-hidden="true">8.</strong> Event Loop</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="blocking_the_event_loop.html"><strong aria-hidden="true">8.1.</strong> Blocking the Event Loop</a></li><li class="chapter-item expanded "><a href="one_step_at_a_time.html"><strong aria-hidden="true">8.2.</strong> One Step at a Time</a></li><li class="chapter-item expanded "><a href="asynchronous_io.html"><strong aria-hidden="true">8.3.</strong> Asynchronous I/O</a></li><li class="chapter-item expanded "><a href="threads_or_processes.html"><strong aria-hidden="true">8.4.</strong> Threads or Processes</a></li><li class="chapter-item expanded "><a href="nested_event_processing.html"><strong aria-hidden="true">8.5.</strong> Nested Event Processing</a></li></ol></li><li class="chapter-item expanded "><a href="menus.html"><strong aria-hidden="true">9.</strong> Menus</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="menubars.html"><strong aria-hidden="true">9.1.</strong> Menubars</a></li><li class="chapter-item expanded "><a href="platform_menus.html"><strong aria-hidden="true">9.2.</strong> Platform Menus</a></li><li class="chapter-item expanded "><a href="contextual_menus.html"><strong aria-hidden="true">9.3.</strong> Contextual Menus</a></li></ol></li><li class="chapter-item expanded "><a href="windows_and_dialogs.html"><strong aria-hidden="true">10.</strong> Windows and Dialogs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="creating_and_destroying_windows.html"><strong aria-hidden="true">10.1.</strong> Creating and Destroying Windows</a></li><li class="chapter-item expanded "><a href="window_behavior_and_styles.html"><strong aria-hidden="true">10.2.</strong> Window Behavior and Styles</a></li><li class="chapter-item expanded "><a href="dialog_windows.html"><strong aria-hidden="true">10.3.</strong> Dialog Windows</a></li></ol></li><li class="chapter-item expanded "><a href="organizing_complex_interfaces.html"><strong aria-hidden="true">11.</strong> Organizing Complex Interfaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="separator.html"><strong aria-hidden="true">11.1.</strong> Separator</a></li><li class="chapter-item expanded "><a href="label_frames.html"><strong aria-hidden="true">11.2.</strong> Label Frames</a></li><li class="chapter-item expanded "><a href="paned_windows.html"><strong aria-hidden="true">11.3.</strong> Paned Windows</a></li><li class="chapter-item expanded "><a href="notebook.html"><strong aria-hidden="true">11.4.</strong> Notebook</a></li></ol></li><li class="chapter-item expanded "><a href="fonts_colors_images.html"><strong aria-hidden="true">12.</strong> Fonts, Colors, Images</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="fonts.html"><strong aria-hidden="true">12.1.</strong> Fonts</a></li><li class="chapter-item expanded "><a href="colors.html"><strong aria-hidden="true">12.2.</strong> Colors</a></li><li class="chapter-item expanded "><a href="images.html"><strong aria-hidden="true">12.3.</strong> Images</a></li></ol></li><li class="chapter-item expanded "><a href="canvas.html"><strong aria-hidden="true">13.</strong> Canvas</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="creating_items.html"><strong aria-hidden="true">13.1.</strong> Creating Items</a></li><li class="chapter-item expanded "><a href="event_bindings.html"><strong aria-hidden="true">13.2.</strong> Event Bindings</a></li><li class="chapter-item expanded "><a href="tags.html"><strong aria-hidden="true">13.3.</strong> Tags</a></li><li class="chapter-item expanded "><a href="scrolling.html"><strong aria-hidden="true">13.4.</strong> Scrolling</a></li></ol></li><li class="chapter-item expanded "><a href="text_chapter.html"><strong aria-hidden="true">14.</strong> Text</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="the_basics.html"><strong aria-hidden="true">14.1.</strong> The Basics</a></li><li class="chapter-item expanded "><a href="modifying_the_text_in_code.html"><strong aria-hidden="true">14.2.</strong> Modifying the Text in Code</a></li><li class="chapter-item expanded "><a href="formatting_with_tags.html"><strong aria-hidden="true">14.3.</strong> Formatting with Tags</a></li><li class="chapter-item expanded "><a href="events_and_bindings.html"><strong aria-hidden="true">14.4.</strong> Events and Bindings</a></li><li class="chapter-item expanded "><a href="selecting_text.html"><strong aria-hidden="true">14.5.</strong> Selecting Text</a></li><li class="chapter-item expanded "><a href="marks.html"><strong aria-hidden="true">14.6.</strong> Marks</a></li><li class="chapter-item expanded "><a href="images_and_widgets.html"><strong aria-hidden="true">14.7.</strong> Images and Widgets</a></li><li class="chapter-item expanded "><a href="even_more.html"><strong aria-hidden="true">14.8.</strong> Even More</a></li></ol></li><li class="chapter-item expanded "><a href="treeview.html"><strong aria-hidden="true">15.</strong> Treeview</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="adding_items_to_the_tree.html"><strong aria-hidden="true">15.1.</strong> Adding Items to the Tree</a></li><li class="chapter-item expanded "><a href="rearranging_items.html"><strong aria-hidden="true">15.2.</strong> Rearranging Items</a></li><li class="chapter-item expanded "><a href="displaying_information_for_each_item.html"><strong aria-hidden="true">15.3.</strong> Displaying Information for each Item</a></li><li class="chapter-item expanded "><a href="item_appearance_and_events.html"><strong aria-hidden="true">15.4.</strong> Item Appearance and Events</a></li><li class="chapter-item expanded "><a href="customizing_the_display.html"><strong aria-hidden="true">15.5.</strong> Customizing the Display</a></li></ol></li><li class="chapter-item expanded "><a href="styles_and_themes.html"><strong aria-hidden="true">16.</strong> Styles and Themes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="using_existing_themes.html"><strong aria-hidden="true">16.1.</strong> Using Existing Themes</a></li><li class="chapter-item expanded "><a href="using_styles.html"><strong aria-hidden="true">16.2.</strong> Using Styles</a></li><li class="chapter-item expanded "><a href="whats_inside_a_style.html"><strong aria-hidden="true">16.3.</strong> What's Inside a Style?</a></li><li class="chapter-item expanded "><a href="manipulating_styles.html"><strong aria-hidden="true">16.4.</strong> Manipulating Styles</a></li><li class="chapter-item expanded "><a href="sound_difficult_to_you.html"><strong aria-hidden="true">16.5.</strong> Sound Difficult to you?</a></li><li class="chapter-item expanded "><a href="advanced_more_on_elements.html"><strong aria-hidden="true">16.6.</strong> Advanced: More on Elements</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="listbox"><a class="header" href="#listbox">Listbox</a></h1>
<p>A <em>listbox</em> widget displays a list of single-line text items, usually lengthy,
and allows users to browse through the list, selecting one or more.</p>
<p>Listboxes are part of the classic Tk widgets; there is not presently a listbox
in the themed Tk widget set.</p>
<blockquote>
<p>Tk's treeview widget (which is themed) can also be used as a listbox (a one
level deep tree), allowing you to use icons and styles with the list. It's also
likely that a multi-column (table) list widget will make it into Tk at some
point, whether based on treeview or one of the available extensions.</p>
</blockquote>
<table><thead><tr><th style="text-align: center">Listbox widgets</th></tr></thead><tbody>
<tr><td style="text-align: center"><img src="./images/w_listbox_all.png" alt="Listbox widgets." /></td></tr>
</tbody></table>
<p>Listboxes are created using the <code>add_tk_listbox</code> method. A height configuration
option can specify the number of lines the listbox will display at a time
without scrolling:</p>
<pre><pre class="playground"><code class="language-rust no_run">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>parent.add_listbox( &quot;l&quot; -height(10) )?;
<span class="boring">}
</span></code></pre></pre>
<h2 id="populating-the-listbox-items"><a class="header" href="#populating-the-listbox-items">Populating the Listbox Items</a></h2>
<p>There's an easy way and a hard way to populate and manage all the items in the
listbox.</p>
<p>Here's the easy way. Each listbox has a <code>listvariable</code> configuration option,
which allows you to link a variable (which must hold a list) to the listbox.
Each element of this list is a string representing one item in the listbox. To
add, remove, or rearrange items in the listbox, you can simply modify this
variable as you would any other list. Similarly, to find out, e.g., which item
is on the third line of the listbox, just look at the third element of the list
variable.</p>
<p>The older, harder way to do things is to use a set of methods that are part of
the listbox widget itself. They operate on the (internal) list of items
maintained by the widget:</p>
<p>The <code>insert( &amp;self, idx: impl Into&lt;ListboxIndex&gt;, elements )</code> method is used to
add one or more items to the list; <code>idx</code> is a 0-based index indicating the
position of the item before which the item(s) should be added; specify
<code>ListboxIndex::End</code> to put the new items at the end of the list.</p>
<p>Use the <code>delete( &amp;self, index: impl Into&lt;Index&gt; )</code> or
<code>delete_range( &amp;self, range: impl Into&lt;TkRange&lt;Index&gt;&gt; )</code> method to delete one
or more items from the list.</p>
<p>Use the <code>get( &amp;self, index: impl Into&lt;Index&gt; )</code> method to return the contents of
a single item at the given position, or use the
<code>get_range( &amp;self, range: impl Into&lt;TkRange&lt;Index&gt;&gt; )</code> method to get a list of
the items in the <code>range</code>. </p>
<p>The <code>size</code> method returns the number of items in the list.</p>
<blockquote>
<p>The reason there is a hard way at all is because the <code>listvariable</code> option was
only introduced in Tk 8.3. Before that, you were stuck with the hard way.
Because using the list variable lets you use all the standard list operations,
it provides a much simpler API. It's certainly an upgrade worth considering if
you have listboxes doing things the older way.</p>
</blockquote>
<h2 id="selecting-items"><a class="header" href="#selecting-items">Selecting Items</a></h2>
<p>You can choose whether users can select only a single item at a time from the
<code>listbox</code>, or if multiple items can simultaneously be selected. This is
controlled by the <code>selectmode</code> option: the default is only being able to select
a single item (<code>browse</code>), while a <code>selectmode</code> of <code>extended</code> allows users to
select multiple items.</p>
<blockquote>
<p>The names <code>browse</code> and <code>extended</code>, again for backward compatibility reasons,
are truly awful. This is made worse by the fact that there are two other modes,
<code>single</code> and <code>multiple</code>, which you <em>should not use</em> (they use an old interaction
style that is inconsistent with modern user interface and platform conventions).</p>
</blockquote>
<p>To find out which item or items in the listbox are currently selected, use the
<code>curselection</code> method. It returns a list of indices of all items currently
selected; this may be an empty list. For lists with a <code>selectmode</code> of <code>browse</code>,
it will never be longer than one item. You can also use the <code>selection_includes</code>
index method to check if the item with the given index is currently selected.</p>
<pre><pre class="playground"><code class="language-rust no_run">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>if lbox.selection_includes( 2 ) { /* omitted */ }
<span class="boring">}
</span></code></pre></pre>
<p>To programmatically change the selection, you can use the
<code>selection_clear( &amp;self, values: impl IntoTkValues&lt;ListboxIndex&gt; )</code> method to
deselect either a single item or any within the range of indices specified. To
select an item or all items in a range, use the
<code>selection_set( &amp;self, values: impl IntoTkValues&lt;ListboxIndex&gt; )</code> method. Both
of these will not touch the selection of any items outside the range specified.</p>
<p>If you change the selection, you should also make sure that the newly selected
item is visible (i.e., it is not scrolled out of view). To do this, use the
<code>see_index</code> method.</p>
<pre><pre class="playground"><code class="language-rust no_run">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>lbox.selection_set( idx )?;
lbox.see( idx )?;
<span class="boring">}
</span></code></pre></pre>
<p>When a user changes the selection, a <code>event::virtual_event( &quot;ListboxSelect&quot; )</code>
is generated. You can bind to this to take any action you need. Depending on
your application, you may also want to bind to a double-click
<code>event::double().button_press_1()</code> event and use it to invoke an action with the
currently selected item.</p>
<pre><pre class="playground"><code class="language-rust no_run">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>lbox.bind( event::virtual_event( &quot;ListboxSelect&quot; ),
    tclosure!( tk, move || -&gt; TkResult&lt;()&gt; {
        Ok( update_details( lbox.curselection()? ))
    }
))?;

lbox.bind( event::double().button_press_1(),
    tclosure!( tk, move || -&gt; TkResult&lt;()&gt; {
        Ok( invoke_action( lbox.curselection()? ))
    }
))?;
<span class="boring">}
</span></code></pre></pre>
<h2 id="stylizing-the-list"><a class="header" href="#stylizing-the-list">Stylizing the List</a></h2>
<p>Like most of the &quot;classic&quot; Tk widgets, you have immense flexibility in modifying
the appearance of a listbox. As described in the
<a href="https://www.tcl.tk/man/tcl/TkCmd/listbox.html"><code>reference manual</code></a>, you can
modify the font the listbox items are displayed in, the foreground (text) and
background colors for items in their normal state, when selected, when the
widget is disabled, etc. There is also an <code>itemconfigure</code> method that allows you
to change the foreground and background colors of individual items.</p>
<p>As is often the case, restraint is useful. Generally, the default values will be
entirely suitable and a good match for platform conventions. In the example
we'll get to momentarily, we'll show how restrained use of these options can be
put to good effect, in this case displaying alternate lines of the listbox in
slightly different colors.</p>
<h2 id="keeping-extra-item-data"><a class="header" href="#keeping-extra-item-data">Keeping Extra Item Data</a></h2>
<p>The <code>listvariable</code> (or the internal list, if you're managing things the old way)
holds the strings that will be shown in the listbox. It's often the case,
though, that each string you're displaying is associated with some other data
item. This might be an internal object that is meaningful to your program, but
not meant to be displayed to users. In other words, what you're really
interested in is not so much the string displayed in the listbox, but the
associated data item. For example, a listbox may display a list of names to
users, but your program is really interested in the underlying user object (or
id number) for each one, not the particular name.</p>
<p>How can we associate this underlying value with the name that is displayed?
Unfortunately, the listbox widget itself doesn't offer any facilities, so it's
something we'll have to manage separately. There are a couple of obvious
approaches. First, if the displayed strings are guaranteed unique, you could use
a hash table to map each name to its associated underlying object. This wouldn't
work well for peoples' names, where duplicates are possible, but could work for
countries, which are unique.</p>
<p>A second approach is to keep a second list, parallel to the list of strings
displayed in the listbox. This second list will hold the underlying object
associated with each item that is displayed. So the first item in the displayed
strings list corresponds to the first item in the underlying objects list, the
second to the second, etc. Any changes that you make in one list (insert,
delete, reorder), you must make in the other. You can then easily map from the
displayed list item to the underlying object, based on their position in the
list.</p>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<p>Here is a silly example showing several of these listbox techniques. We'll have
a list of countries displayed. We'll be able to select only a single country at
a time. As we do so, a status bar will display the population of the country.
You can press a button to send one of several gifts to the selected country's
head of state (well, not really, but use your imagination). Sending a gift can
also be triggered by double-clicking the list or hitting the Return key.</p>
<p>Behind the scenes, we maintain two lists in parallel. The first is a list of
two-letter country codes. The other is the corresponding name for each country
that we will display in the listbox. We also have a simple hash table that
contains the population of each country, indexed by the two-letter country code.</p>
<table><thead><tr><th style="text-align: center">Country selector listbox example</th></tr></thead><tbody>
<tr><td style="text-align: center"><img src="./images/country_w.png" alt="Country selector listbox example." /></td></tr>
</tbody></table>
<pre><pre class="playground"><code class="language-rust no_run">// cargo run --example listbox

use std::collections::HashMap;

use tcl::*;
use tk::*;
use tk::cmd::*;

fn main() -&gt; TkResult&lt;()&gt; {
    let tk = make_tk!()?;
    let root = tk.root();

    // Initialize our country &quot;databases&quot;:
    //  - the list of country codes (a subset anyway)
    //  - parallel list of country names, same order as the country codes
    //  - a hash table mapping country code to population
    tk.set( &quot;countrycodes&quot;, vec![
        &quot;ar&quot;, &quot;au&quot;, &quot;be&quot;, &quot;br&quot;, &quot;ca&quot;, &quot;cn&quot;, &quot;dk&quot;, &quot;fi&quot;, &quot;fr&quot;, &quot;gr&quot;,
        &quot;in&quot;, &quot;it&quot;, &quot;jp&quot;, &quot;mx&quot;, &quot;nl&quot;, &quot;no&quot;, &quot;es&quot;, &quot;se&quot;, &quot;ch&quot; ]);

    tk.set( &quot;countrynames&quot;, vec![
        &quot;Argentina&quot;, &quot;Australia&quot;, &quot;Belgium&quot;, &quot;Brazil&quot;, &quot;Canada&quot;, &quot;China&quot;,
        &quot;Denmark&quot;, &quot;Finland&quot;, &quot;France&quot;, &quot;Greece&quot;, &quot;India&quot;, &quot;Italy&quot;, &quot;Japan&quot;,
        &quot;Mexico&quot;, &quot;Netherlands&quot;, &quot;Norway&quot;, &quot;Spain&quot;, &quot;Sweden&quot;, &quot;Switzerland&quot; ]);

    let mut populations = HashMap::new();

    populations.insert( &quot;ar&quot;,   41000000 );
    populations.insert( &quot;au&quot;,   21179211 );
    populations.insert( &quot;be&quot;,   10584534 );
    populations.insert( &quot;br&quot;,  185971537 );
    populations.insert( &quot;ca&quot;,   33148682 );
    populations.insert( &quot;cn&quot;, 1323128240 );
    populations.insert( &quot;dk&quot;,    5457415 );
    populations.insert( &quot;fi&quot;,    5302000 );
    populations.insert( &quot;fr&quot;,   64102140 );
    populations.insert( &quot;gr&quot;,   11147000 );
    populations.insert( &quot;in&quot;, 1131043000 );
    populations.insert( &quot;it&quot;,   59206382 );
    populations.insert( &quot;jp&quot;,  127718000 );
    populations.insert( &quot;mx&quot;,  106535000 );
    populations.insert( &quot;nl&quot;,   16402414 );
    populations.insert( &quot;no&quot;,    4738085 );
    populations.insert( &quot;es&quot;,   45116894 );
    populations.insert( &quot;se&quot;,    9174082 );
    populations.insert( &quot;ch&quot;,    7508700 );

    tk.set( &quot;populations&quot;, populations );

    // Names of the gifts we can send
    tk.arr_set( &quot;gifts&quot;, &quot;card&quot;     , &quot;Greeting card&quot; );
    tk.arr_set( &quot;gifts&quot;, &quot;flowers&quot;  , &quot;Flowers&quot;       );
    tk.arr_set( &quot;gifts&quot;, &quot;nastygram&quot;, &quot;Nastygram&quot;     );

    // Create and grid the outer content frame
    let c = root.add_ttk_frame( &quot;c&quot; -padding(( 5, 5, 12, 0 )) )?
        .grid( -column(0) -row(0) -sticky(&quot;nwes&quot;) )?;
    root.grid_columnconfigure( 0, -weight(1) )?;
    root.grid_rowconfigure(    0, -weight(1) )?;

    // Create the different widgets; note the variables that many
    // of them are bound to, as well as the button callback.
    // The listbox is the only widget we'll need to refer to directly
    // later in our program, so for convenience we'll assign it to a variable.
    let lbox = c.add_listbox( &quot;countries&quot; -listvariable(&quot;countrynames&quot;) -height(5) )?;
    c.add_ttk_label( &quot;lbl&quot; -text(&quot;Send to country's leader:&quot;) )?;
    c.add_ttk_radiobutton( &quot;g1&quot; -text( tk.arr_get( &quot;gifts&quot;, &quot;card&quot;      )? ) -variable(&quot;gift&quot;) -value(&quot;card&quot;) )?;
    c.add_ttk_radiobutton( &quot;g2&quot; -text( tk.arr_get( &quot;gifts&quot;, &quot;flowers&quot;   )? ) -variable(&quot;gift&quot;) -value(&quot;flowers&quot;) )?;
    c.add_ttk_radiobutton( &quot;g3&quot; -text( tk.arr_get( &quot;gifts&quot;, &quot;nastygram&quot; )? ) -variable(&quot;gift&quot;) -value(&quot;nastygram&quot;) )?;
    c.add_ttk_button( &quot;send&quot;    -text(&quot;Send Gift&quot;) -command(&quot;send_gift&quot;) -default_(&quot;active&quot;) )?;
    c.add_ttk_label(  &quot;sentlbl&quot; -textvariable(&quot;sentmsg&quot;)   -anchor(&quot;center&quot;) )?;
    c.add_ttk_label(  &quot;status&quot;  -textvariable(&quot;statusmsg&quot;) -anchor(&quot;w&quot;) )?;

    // Grid all the widgets
    tk.grid( &quot;.c.countries&quot; -column(0) -row(0) -rowspan(6) -sticky(&quot;nsew&quot;) )?;
    tk.grid( &quot;.c.lbl&quot;       -column(1) -row(0) -padx(10) -pady(5) )?;
    tk.grid( &quot;.c.g1&quot;        -column(1) -row(1) -sticky(&quot;w&quot;) -padx(20) )?;
    tk.grid( &quot;.c.g2&quot;        -column(1) -row(2) -sticky(&quot;w&quot;) -padx(20) )?;
    tk.grid( &quot;.c.g3&quot;        -column(1) -row(3) -sticky(&quot;w&quot;) -padx(20) )?;
    tk.grid( &quot;.c.send&quot;      -column(2) -row(4) -sticky(&quot;e&quot;) )?;
    tk.grid( &quot;.c.sentlbl&quot;   -column(1) -row(5) -columnspan(2) -sticky(&quot;n&quot;) -pady(5) -padx(5) )?;
    tk.grid( &quot;.c.status&quot;    -column(0) -row(6) -columnspan(2) -sticky(&quot;we&quot;) )?;
    c.grid_columnconfigure( 0, -weight(1) )?;
    c.grid_rowconfigure(    5, -weight(1) )?;

    // Set event bindings for when the selection in the listbox changes,
    // when the user double clicks the list, and when they hit the Return key
    lbox.bind( event::virtual_event( &quot;ListboxSelect&quot; ), &quot;show_population&quot; )?;
    lbox.bind( event::double().button_press_1(), &quot;send_gift&quot; )?;
    root.bind( event::key_press( TkKey::Return ), &quot;send_gift&quot; )?;

    // Called when the selection in the listbox changes; figure out
    // which country is currently selected, and then lookup its country
    // code, and from that, its population.  Update the status message
    // with the new population.  As well, clear the message about the
    // gift being sent, so it doesn't stick around after we start doing
    // other things.
    tclosure!( tk, cmd: &quot;show_population&quot;, move || -&gt; TkResult&lt;()&gt; {
        let interp = tcl_interp!();
        let idx = lbox.curselection()?;
        if idx.len() == 1 {
            let idx = idx[0];
            let code = interp.get( &quot;countrycodes&quot; )?.list_index( idx )?
                .map( |obj| obj.get_string() ).unwrap_or_default();
            let name = interp.get( &quot;countrynames&quot; )?.list_index( idx )?
                .map( |obj| obj.get_string() ).unwrap_or_default();
            let popn = interp.get(&quot;populations&quot;)?.dict_get( code.clone() )?
                .map( |obj| obj.get_string() ).unwrap_or_default();
            interp.set( &quot;statusmsg&quot;,
                format!( &quot;The population of {}({}) is {}&quot;, name, code, popn ));
        }
        interp.set( &quot;sentmsg&quot;, &quot;&quot; );
        Ok(())
    });

    // Called when the user double clicks an item in the listbox, presses
    // the &quot;Send Gift&quot; button, or presses the Return key.  In case the selected
    // item is scrolled out of view, make sure it is visible.
    //
    // Figure out which country is selected, which gift is selected with the
    // radiobuttons, &quot;send the gift&quot;, and provide feedback that it was sent.
    tclosure!( tk, cmd: &quot;send_gift&quot;, move || -&gt; TkResult&lt;()&gt; {
        let interp = tcl_interp!();
        let idx = lbox.curselection()?;
        if idx.len() == 1 {
            let idx = idx[0];
            lbox.see( idx )?;
            let gift = interp.get(&quot;gift&quot;)?;
            let gift = interp.arr_get( &quot;gifts&quot;, gift )?;
            let name = interp
                .get( &quot;countrynames&quot; )?
                .list_index( idx )?
                .map( |obj| obj.get_string() )
                .unwrap_or_default();
            // Gift sending left as an exercise to the reader
            interp.set( &quot;sentmsg&quot;,
                format!( &quot;Sent {} to leader of {}&quot;, gift, name ));
        }
        Ok(())
    });

    // Colorize alternating lines of the listbox
    let len = tk.get( &quot;countrynames&quot; )?.list_length()?;
    (0..len).step_by(2).try_for_each( |i| -&gt; InterpResult&lt;()&gt; {
        Ok( lbox.itemconfigure( i, -background(&quot;#f0f0ff&quot;) )? )
    })?;

    // Set the starting state of the interface, including selecting the
    // default gift to send, and clearing the messages.  Select the first
    // country in the list; because the &lt;&lt;ListboxSelect&gt;&gt; event is only
    // fired when users makes a change, we explicitly call showPopulation.
    tk.set( &quot;gift&quot;, &quot;card&quot; );
    tk.set( &quot;sentmsg&quot;, &quot;&quot; );
    tk.set( &quot;statusmsg&quot;, &quot;&quot; );
    lbox.selection_set_range( 0.. )?;
    tk.run( &quot;show_population&quot; )?;

    Ok( main_loop() )
}
</code></pre></pre>
<p>One obvious thing missing from this example was that while the list of countries
could be quite long, only part of it fits on the screen at once. To show
countries further down in the list, you had to either drag with your mouse or
use the down arrow key. A scrollbar would have been nice. Let's fix that.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="more_widgets.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="scrollbar.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="more_widgets.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="scrollbar.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
